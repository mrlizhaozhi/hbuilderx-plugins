"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getGrammarCompletionData=void 0;const vscode_languageserver_1=require("vscode-languageserver"),vscode_uri_1=require("vscode-uri"),entry_1=require("../../../../htmlservice/entry"),utils_1=require("../../../../utils"),util_1=require("../utils/util");async function getGrammarCompletionData(e,t,r,i,l){if(!(0,util_1.isRightCompletionType)(i,void 0,[util_1.NodeType.ClassSelector,util_1.NodeType.IdentifierSelector,util_1.NodeType.ElementNameSelector],util_1.NodeType.Selector))return l;let a=l.items;for(var s=a.length-1;s>=0;--s)util_1.html5Tags.includes(a[s].label)&&a.splice(s,1);let o=(0,entry_1.getHtmlTags)(e);for(s=a.length-1;s>=0;--s)o.includes(a[s].label)&&a.splice(s,1);let n=t.offsetAt(r),d=(0,util_1.getCurrentWord)(t,n),u=vscode_languageserver_1.Position.create(r.line,r.character-d.length);for(let e of o)e.length>0&&a.push({label:e,textEdit:vscode_languageserver_1.TextEdit.replace(vscode_languageserver_1.Range.create(u,r),e),kind:vscode_languageserver_1.CompletionItemKind.Keyword,data:{hxKind:utils_1.HxIconKind.ELEMENT}});if(!e)return console.error("getGrammarCompletionData.workspaceFolder is undefined"),l;let c=vscode_uri_1.URI.parse(t.uri).fsPath,_=vscode_uri_1.URI.parse(e.uri).fsPath;return(0,utils_1.getProjectType)(_)===utils_1.ProjectType.PT_UniApp_Vue&&(c.endsWith(".nvue")||c.endsWith(".vue")||c.endsWith(".css")||c.endsWith(".scss")||c.endsWith(".less")||c.endsWith(".styl"))&&a.push({label:"page",textEdit:vscode_languageserver_1.TextEdit.replace(vscode_languageserver_1.Range.create(u,r),"page"),documentation:{kind:"markdown",value:"Equivalent to the body node"},kind:vscode_languageserver_1.CompletionItemKind.Keyword,data:{hxKind:utils_1.HxIconKind.ELEMENT}}),l}exports.getGrammarCompletionData=getGrammarCompletionData;