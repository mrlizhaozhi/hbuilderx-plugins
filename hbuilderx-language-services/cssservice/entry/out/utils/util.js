"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.transitionTimingFunctions=exports.TokenType=exports.svgElements=exports.startsWith=exports.SortTexts=exports.repeatStyleKeywords=exports.positionKeywords=exports.numberType=exports.notMoveCursorProperty=exports.NodeType=exports.lineWidthKeywords=exports.lineStyleKeywords=exports.isSameRange=exports.isRightCompletionType=exports.includesList=exports.imageUrlProperty=exports.imageFunctions=exports.html5Tags=exports.getOffsetRightLineText=exports.getOffsetLeftLineText=exports.getNodeAtOffset=exports.getLocationFromText=exports.getLocationFromPosition=exports.getLineTextFromPosition=exports.getLineTextFromOffset=exports.getHXSettings=exports.getCurrentWord=exports.getContextData=exports.geometryBoxKeywords=exports.cssWideKeywords=exports.createDocument=exports.createAstNode=exports.colors=exports.colorRestrictions=exports.colorKeywords=exports.colorFunctions=exports.calcRestrictionTypes=exports.boxKeywords=exports.basicShapeFunctions=void 0;const fs_1=require("fs"),vscode_css_languageservice_1=require("vscode-css-languageservice"),vscode_languageserver_1=require("vscode-languageserver"),vscode_languageserver_textdocument_1=require("vscode-languageserver-textdocument"),vscode_uri_1=require("vscode-uri"),utils_1=require("../../../../utils");function getCurrentWord(e,t){let r=t-1;const o=e.getText();for(;r>=0&&-1===' \t\n\r":{[()]},*>+'.indexOf(o.charAt(r));)r--;return o.substring(r+1,t)}function getNodeAtOffset(e,t){let r=null;return!e||t<e.offset||t>e.end?null:(e.accept((e=>-1===e.offset&&-1===e.length||e.offset<=t&&e.end>=t&&(r?e.length<=r.length&&(r=e):r=e,!0))),r)}function getLineTextFromPosition(e,t){const r=e.getText().length,o=e.positionAt(r),n=e.lineCount,s=vscode_languageserver_1.Position.create(t.line,0);if(n===t.line+1){const t=vscode_languageserver_1.Range.create(s,o);return e.getText(t)}const i=t.line+1,u=vscode_languageserver_1.Position.create(i,0),c=e.offsetAt(u),a=e.positionAt(c-1),g=vscode_languageserver_1.Range.create(s,a);return e.getText(g)}function getLineTextFromOffset(e,t){const r=e.positionAt(t);return getLineTextFromPosition(e,r)}function getOffsetRightLineText(e,t){const r=getLineTextFromOffset(e,t),o=e.positionAt(t);return r.substring(o.character)}function getOffsetLeftLineText(e,t){const r=e.positionAt(t),o=vscode_languageserver_1.Position.create(r.line,0),n=vscode_languageserver_1.Range.create(o,r);return e.getText(n)}function isSameRange(e,t){return e.start.line===t.start.line&&(e.start.character===t.start.character&&(e.end.line===t.end.line&&e.end.character===t.end.character))}function getLocationFromPosition(e,t,r){const o=getNodeAtOffset(t,e.offsetAt(r));if(!o)return;const n=e.positionAt(o.offset),s=e.positionAt(o.end),i=vscode_languageserver_1.Range.create(n,s);return{uri:e.uri,range:i}}function createDocument(e,t){let r=(0,fs_1.readFileSync)(vscode_uri_1.URI.parse(e).fsPath,{encoding:"utf8",flag:"r"});return vscode_languageserver_textdocument_1.TextDocument.create(e,t,0,r)}function createAstNode(e,t){return"css"===t?(0,vscode_css_languageservice_1.getCSSLanguageService)().parseStylesheet(e):"scss"===t?(0,vscode_css_languageservice_1.getSCSSLanguageService)().parseStylesheet(e):"less"===t?(0,vscode_css_languageservice_1.getLESSLanguageService)().parseStylesheet(e):(console.error("fileType is not style"),(0,vscode_css_languageservice_1.getCSSLanguageService)().parseStylesheet(e))}function getLocationFromText(e,t,r,o){let n=[];return t.accept((t=>{if(t.type===r){if(t.getText()===o){let r=e.positionAt(t.offset),o=e.positionAt(t.end),s=vscode_languageserver_1.Range.create(r,o);n.push({uri:e.uri,range:s})}return!1}return!0})),n}function getHXSettings(e,t,r){if(!r)return Promise.resolve(void 0);const o={items:[{section:e}]};return t.sendRequest(vscode_languageserver_1.ConfigurationRequest.type,o).then((e=>e[0]))}function isRightCompletionType(e,t,r,o,n){if(!e)return!1;if(e.isNode){if(t)for(const r of t){if(e.type===r)return!0;if(e.parentType===r)return!0}if(r)for(const t of r){if(e.nodeType===t)return!0;if(e.parentNodeType===t)return!0}}else{if(o&&e.nodeType===o)return!0;if(n&&e.context===n)return!0}return!1}function getContextData(e,t,r){let o=t-1;const n=e.getText();let s=' \t\n\r":{[()]},*>+'+r;for(r||(s=' \t\n\r":{[()]},*>+');o>=0&&-1===s.indexOf(n.charAt(o));)o--;let i=n.substring(o+1,t),u=vscode_languageserver_1.Range.create(e.positionAt(o+1),e.positionAt(t)),c=t;for(;c!=n.length&&-1===s.indexOf(n.charAt(c));)c++;let a=n.substring(t,c),g=vscode_languageserver_1.Range.create(e.positionAt(t),e.positionAt(c));return{context:i+a,leftText:i,rightText:a,contextRange:vscode_languageserver_1.Range.create(e.positionAt(o+1),e.positionAt(c)),leftRange:u,rightRange:g}}Object.defineProperty(exports,"basicShapeFunctions",{enumerable:!0,get:function(){return utils_1.basicShapeFunctions}}),Object.defineProperty(exports,"boxKeywords",{enumerable:!0,get:function(){return utils_1.boxKeywords}}),Object.defineProperty(exports,"calcRestrictionTypes",{enumerable:!0,get:function(){return utils_1.calcRestrictionTypes}}),Object.defineProperty(exports,"colorFunctions",{enumerable:!0,get:function(){return utils_1.colorFunctions}}),Object.defineProperty(exports,"colorKeywords",{enumerable:!0,get:function(){return utils_1.colorKeywords}}),Object.defineProperty(exports,"colorRestrictions",{enumerable:!0,get:function(){return utils_1.colorRestrictions}}),Object.defineProperty(exports,"colors",{enumerable:!0,get:function(){return utils_1.colors}}),Object.defineProperty(exports,"cssWideKeywords",{enumerable:!0,get:function(){return utils_1.cssWideKeywords}}),Object.defineProperty(exports,"geometryBoxKeywords",{enumerable:!0,get:function(){return utils_1.geometryBoxKeywords}}),Object.defineProperty(exports,"html5Tags",{enumerable:!0,get:function(){return utils_1.html5Tags}}),Object.defineProperty(exports,"imageFunctions",{enumerable:!0,get:function(){return utils_1.imageFunctions}}),Object.defineProperty(exports,"imageUrlProperty",{enumerable:!0,get:function(){return utils_1.imageUrlProperty}}),Object.defineProperty(exports,"includesList",{enumerable:!0,get:function(){return utils_1.includesList}}),Object.defineProperty(exports,"lineStyleKeywords",{enumerable:!0,get:function(){return utils_1.lineStyleKeywords}}),Object.defineProperty(exports,"lineWidthKeywords",{enumerable:!0,get:function(){return utils_1.lineWidthKeywords}}),Object.defineProperty(exports,"NodeType",{enumerable:!0,get:function(){return utils_1.NodeType}}),Object.defineProperty(exports,"notMoveCursorProperty",{enumerable:!0,get:function(){return utils_1.notMoveCursorProperty}}),Object.defineProperty(exports,"numberType",{enumerable:!0,get:function(){return utils_1.numberType}}),Object.defineProperty(exports,"positionKeywords",{enumerable:!0,get:function(){return utils_1.positionKeywords}}),Object.defineProperty(exports,"repeatStyleKeywords",{enumerable:!0,get:function(){return utils_1.repeatStyleKeywords}}),Object.defineProperty(exports,"SortTexts",{enumerable:!0,get:function(){return utils_1.SortTexts}}),Object.defineProperty(exports,"startsWith",{enumerable:!0,get:function(){return utils_1.startsWith}}),Object.defineProperty(exports,"svgElements",{enumerable:!0,get:function(){return utils_1.svgElements}}),Object.defineProperty(exports,"TokenType",{enumerable:!0,get:function(){return utils_1.TokenType}}),Object.defineProperty(exports,"transitionTimingFunctions",{enumerable:!0,get:function(){return utils_1.transitionTimingFunctions}}),exports.getCurrentWord=getCurrentWord,exports.getNodeAtOffset=getNodeAtOffset,exports.getLineTextFromPosition=getLineTextFromPosition,exports.getLineTextFromOffset=getLineTextFromOffset,exports.getOffsetRightLineText=getOffsetRightLineText,exports.getOffsetLeftLineText=getOffsetLeftLineText,exports.isSameRange=isSameRange,exports.getLocationFromPosition=getLocationFromPosition,exports.createDocument=createDocument,exports.createAstNode=createAstNode,exports.getLocationFromText=getLocationFromText,exports.getHXSettings=getHXSettings,exports.isRightCompletionType=isRightCompletionType,exports.getContextData=getContextData;