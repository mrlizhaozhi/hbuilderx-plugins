"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ParseUtil=void 0;const ts=require("typescript/lib/tsserverlibrary");var ParseUtil;!function(t){function e(t){const e=function(t){switch(t.kind){case ts.SyntaxKind.StringLiteral:case ts.SyntaxKind.NoSubstitutionTemplateLiteral:case ts.SyntaxKind.NumericLiteral:if(t.parent.kind===ts.SyntaxKind.ComputedPropertyName)return ts.isObjectLiteralElement(t.parent.parent)?t.parent.parent:void 0;case ts.SyntaxKind.Identifier:return!ts.isObjectLiteralElement(t.parent)||t.parent.parent.kind!==ts.SyntaxKind.ObjectLiteralExpression&&t.parent.parent.kind!==ts.SyntaxKind.JsxAttributes||t.parent.name!==t?void 0:t.parent}return}(t);return e&&(ts.isObjectLiteralExpression(e.parent)||ts.isJsxAttributes(e.parent))?e:void 0}function n(t){return t.kind===ts.SyntaxKind.ComputedPropertyName?ts.isStringLiteralLike(t.expression)||ts.isNumericLiteral(t.expression)?t.expression.text:void 0:ts.isPrivateIdentifier(t)?ts.idText(t):(e=t,ts.isMemberName(e)?ts.idText(e):e.text);var e}function i(t,i){if(!t||!t.parent)return[];var r=e(t);if(r){const t=n(r.name);if(!t)return[];var s=i.getContextualType(r.parent);if(s){var a=s.getProperty(t);if(a)return[a]}}return[i.getSymbolAtLocation(t)]}function r(t){if(t.kind===ts.SyntaxKind.SourceFile){let e=t.statements;for(let t=0;t<(null==e?void 0:e.length);++t){let n=e[t];if((null==n?void 0:n.kind)===ts.SyntaxKind.ExportAssignment){let t=n.expression;for(let e=0;e<t.getChildCount();++e){let n=t.getChildAt(e);if(n.kind===ts.SyntaxKind.SyntaxList)return n}}}}return null}function s(t){var e,n;let i={mapActions:null,mapMutations:null},s=function(t){let e=r(t);if(e)for(let t=0;t<e.getChildCount();++t){let n=e.getChildAt(t);if(n.kind===ts.SyntaxKind.PropertyAssignment){let t=n;if("methods"===t.name.getText()&&(null==t?void 0:t.initializer.kind)===ts.SyntaxKind.ObjectLiteralExpression)return t.initializer}}return null}(t);if(s&&s.kind===ts.SyntaxKind.ObjectLiteralExpression){let t=s;for(let r=0;r<t.properties.length;++r){let s=t.properties[r];if(s.kind===ts.SyntaxKind.SpreadAssignment){let t=s.expression;if(t.kind===ts.SyntaxKind.CallExpression&&(null===(e=t)||void 0===e?void 0:e.expression.kind)===ts.SyntaxKind.Identifier){let e=null===(n=t)||void 0===n?void 0:n.expression;"mapActions"===e.escapedText?i.mapActions=t.arguments[0]:"mapMutations"===e.escapedText&&(i.mapMutations=t.arguments[0])}}}}return i}function a(t){let e=[],n=r(t);if(n)for(let t=0;t<n.getChildCount();++t){let i=n.getChildAt(t);if(i.kind===ts.SyntaxKind.PropertyAssignment){let t=i;if("computed"===t.name.getText()&&(null==t?void 0:t.initializer.kind)===ts.SyntaxKind.CallExpression){let n=t.initializer;if(n.expression.kind===ts.SyntaxKind.Identifier&&"mapState"===n.expression.escapedText){let t=n.arguments[0];if(!t)return e;e.push(...o(t))}}}}return e}function o(t){let e=[];if(!t)return e;if(t.kind===ts.SyntaxKind.ObjectLiteralExpression){t.forEachChild((t=>{if(t.kind===ts.SyntaxKind.PropertyAssignment){let n=t.name.getText();e.push(n)}}))}else if(t.kind===ts.SyntaxKind.ArrayLiteralExpression){t.forEachChild((t=>{if(t.kind===ts.SyntaxKind.StringLiteral){let n=t.text;e.push(n)}}))}return e}function l(t){let e=[];const{mapActions:n}=s(t);return n&&e.push(...o(n)),e}function p(t){let e=[];const{mapMutations:n}=s(t);return n&&e.push(...o(n)),e}t.getDefinitionSymbolAtLocation=i,t.getTypesAtLocation=function(t,e){if(!t||!t.parent)return[];let n=e.getProgram();if(null==n)return[];let r=n.getTypeChecker();switch(t.parent.kind){case ts.SyntaxKind.PropertyAccessExpression:{let e=null,n=t.parent.expression;if(n.kind===ts.SyntaxKind.PropertyAccessExpression){if(e=n.name,n.expression.kind===ts.SyntaxKind.PropertyAccessExpression){let t=i(e,r);for(let e=0;e<t.length;++e){if(!t[e])continue;let n=r.getTypeOfSymbolAtLocation(t[e],t[e].valueDeclaration);if("Dictionary<string>"===r.typeToString(n))return["VueRouterParams"]}}}return[]}case ts.SyntaxKind.PropertyAssignment:var s=i(t.parent.name,r);if(s&&s.length>0){let t=[];return s.forEach((e=>{let n=r.getTypeOfSymbolAtLocation(e,e.valueDeclaration);r.typeToString(n).split("|").forEach((e=>{t.push(e.trim())}))})),t}return[];case ts.SyntaxKind.CallExpression:{let e=[],n=t.parent,s=n.expression;if((null==s?void 0:s.kind)===ts.SyntaxKind.ImportKeyword)return["HBuilderX.ImportURIString"];let a=null,o=null;s.kind===ts.SyntaxKind.PropertyAccessExpression&&(a=s.name,o=s.expression);let l=i(a||n.expression,r),p=i(o,r);return l.push(...p),l&&l.length>0&&l.forEach((t=>{let n=r.getTypeOfSymbolAtLocation(t,null==t?void 0:t.valueDeclaration),i=r.typeToString(n),s=i.match(/\(.+?\)/g);s?null==s||s.forEach((t=>{let n=(t=t.substring(1,t.length-1)).includes(",")?t.split(","):[t];for(let t of n)t=t.includes(":")?t.substring(t.lastIndexOf(":")+1,t.length).trim():t.trim(),t.split("|").forEach((t=>{e.push(t.trim())}))})):e.push(i)})),e}case ts.SyntaxKind.BinaryExpression:{let e=[],n=t.parent.left;if(n.kind===ts.SyntaxKind.PropertyAccessExpression){let t=n,s=n.name;if(s.kind!==ts.SyntaxKind.Identifier)return[];let a=s.getText();if("src"!==a&&"href"!==a)return[];i(t.expression,r).forEach((t=>{let n=r.getTypeOfSymbolAtLocation(t,t.valueDeclaration),i=r.typeToString(n);"HTMLScriptElement"===i&&"src"===a?e.push("JSURIString"):"CSSImportRule"!==i&&"StyleSheet"!==i&&"HTMLLinkElement"!==i&&"href"!==a||e.push("CSSURIString")}))}return e}case ts.SyntaxKind.ImportDeclaration:return["HBuilderX.ImportURIString"]}return[]},t.getParamTypes=function(t,e,n){let i=[],r=n.getSignatureHelpItems(t,e,{triggerReason:{kind:"invoked"}});if(r)for(let t of r.items)if(t.parameters.length>r.argumentIndex){let e=t.parameters[r.argumentIndex],n=ts.displayPartsToString(e.displayParts).split(":");n.length>1&&i.push(...n[1].split("|"))}return Array.from(new Set(i))},t.getVuexState=a,t.getVuexActions=l,t.getVuexMutations=p,t.getVuexInfo=function(t){return{state:a(t),actions:l(t),mutations:p(t)}}}(ParseUtil=exports.ParseUtil||(exports.ParseUtil={}));