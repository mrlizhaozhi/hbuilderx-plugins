"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.gotoDefinition=exports.doComplete=void 0;const path=require("path"),fs=require("fs"),vscode_languageserver_protocol_1=require("vscode-languageserver-protocol"),uniCloudPath_1=require("../common/uniCloudPath");function doComplete(e,t,o){let n=[],r=new Set;if(null==o?void 0:o.workspaceFolder){(0,uniCloudPath_1.getAllCloudFunctions)(o.workspaceFolder).forEach((e=>{r.add(e.name)}))}return r.forEach((e=>{n.push({label:e,kind:vscode_languageserver_protocol_1.CompletionItemKind.Property,documentation:e})})),n}function gotoDefinition(e,t){if(null==t?void 0:t.workspaceFolder){let o=(0,uniCloudPath_1.getAllCloudFunctions)(t.workspaceFolder);for(let n of o)if(n.name==e){let o=path.join(n.path,"index.js");if(!fs.existsSync(o))return;if(t.fileName.endsWith(".ts")||t.fileName.endsWith(".js")){return{definitions:[{textSpan:{start:0,length:0},fileName:o,contextSpan:{start:0,length:0}}],textSpan:{start:"jql-helper-docs.ts"==t.fileName?t.token.pos+t.offset-uniCloudPath_1.jqlPrefix.length:t.token.pos+1,length:e.length}}}return{definitions:[{textSpan:{start:0,length:0},originSelectionRange:{start:{line:t.range.start.line,character:t.range.start.character},end:{line:t.range.end.line,character:t.range.start.character}},targetRange:{start:{line:0,character:0},end:{line:0,character:0}},targetSelectionRange:{start:{line:0,character:0},end:{line:0,character:0}},fileName:o}]}}}}exports.doComplete=doComplete,exports.gotoDefinition=gotoDefinition;