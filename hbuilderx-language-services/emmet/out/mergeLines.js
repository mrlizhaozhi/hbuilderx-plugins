"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.mergeLines=void 0;const vscode=require("vscode"),util_1=require("./util"),parseDocument_1=require("./parseDocument");function mergeLines(){if(!(0,util_1.validate)(!1)||!vscode.window.activeTextEditor)return;const e=vscode.window.activeTextEditor,t=(0,parseDocument_1.getRootNode)(e.document,!0);return t?e.edit((o=>{Array.from(e.selections).reverse().forEach((r=>{const n=getRangesToReplace(e.document,r,t);n&&o.replace(n.range,n.newText)}))})):void 0}function getRangesToReplace(e,t,o){let r,n;const i=e.offsetAt(t.start),s=e.offsetAt(t.end);if(t.isEmpty?r=n=(0,util_1.getFlatNode)(o,i,!0):(r=(0,util_1.getFlatNode)(o,i,!0),n=(0,util_1.getFlatNode)(o,s,!0)),!r||!n)return;const c=e.positionAt(r.start),a=c.line,u=c.character,d=e.positionAt(n.end).line;if(a===d)return;const l=(0,util_1.offsetRangeToVsRange)(e,r.start,n.end);let f=e.lineAt(a).text.substr(u);for(let t=a+1;t<=d;t++)f+=e.lineAt(t).text.trim();return new vscode.TextEdit(l,f)}exports.mergeLines=mergeLines;