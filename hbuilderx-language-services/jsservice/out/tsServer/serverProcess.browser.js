"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.WorkerServerProcess=void 0;class WorkerServerProcess{constructor(r,e){this.worker=r,this._onDataHandlers=new Set,this._onErrorHandlers=new Set,this._onExitHandlers=new Set,r.addEventListener("message",(r=>{for(const e of this._onDataHandlers)e(r.data)})),r.postMessage(e)}static fork(r,e,s,o){const t=new Worker(r);return new WorkerServerProcess(t,e)}write(r){this.worker.postMessage(r)}onData(r){this._onDataHandlers.add(r)}onError(r){this._onErrorHandlers.add(r)}onExit(r){this._onExitHandlers.add(r)}kill(){this.worker.terminate()}}exports.WorkerServerProcess=WorkerServerProcess;