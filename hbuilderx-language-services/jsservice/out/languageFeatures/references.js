"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.register=void 0;const vscode=require("vscode"),typescriptService_1=require("../typescriptService"),dependentRegistration_1=require("../utils/dependentRegistration"),typeConverters=require("../utils/typeConverters");class TypeScriptReferenceSupport{constructor(e){this.client=e}async provideReferences(e,t,r,i){const n=this.client.toOpenedFilePath(e);if(!n)return[];const s=typeConverters.Position.toFileLocationRequestArgs(n,t),o=await this.client.execute("references",s,i);if("response"!==o.type||!o.body)return[];const c=[];for(const e of o.body.refs){const t=this.client.toResource(e.file),r=typeConverters.Location.fromTextSpan(t,e);c.push(r)}return c}}function register(e,t){return(0,dependentRegistration_1.conditionalRegistration)([(0,dependentRegistration_1.requireSomeCapability)(t,typescriptService_1.ClientCapability.EnhancedSyntax,typescriptService_1.ClientCapability.Semantic)],(()=>vscode.languages.registerReferenceProvider(e.syntax,new TypeScriptReferenceSupport(t))))}exports.register=register;