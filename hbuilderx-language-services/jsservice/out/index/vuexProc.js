"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getVuexIndexProc=void 0;const indexlib_1=require("./../../../indexlib"),utils_1=require("./utils");function getVuexIndexProc(e){let t=new Set;return{support:(e,t)=>e.getText().indexOf("vuex")>0,onImportDeclaration(e,n){var i,l,o;if("vuex"===(0,utils_1.removeQuot)(n.moduleSpecifier.getText())){let e=null!==(o=null===(l=null===(i=n.importClause)||void 0===i?void 0:i.name)||void 0===l?void 0:l.getText())&&void 0!==o?o:"";e&&t.add(e)}return null},onNewExpression(e,n,i,l){var o,s;if(!i||!n.arguments||0===n.arguments.length)return null;let r=i.getText();if(r.endsWith(".Store")&&t.has(r.slice(0,-6))){let t=n.arguments[0],i=null!==(s=null===(o=utils_1.tsConvert.asTsObjectLiteralExpression(t))||void 0===o?void 0:o.properties)&&void 0!==s?s:[],r=[],u=[],a=[];for(let t=0;t<i.length;t++){let n=utils_1.tsConvert.asTsPropertyAssignment(i[t]);if(n){const t=n.name.getText();let i;if(/^['\"]?state['\"]?$/.test(t)?i=r:/^['\"]?mutations['\"]?$/.test(t)?i=u:/^['\"]?actions['\"]?$/.test(t)&&(i=a),i){let t=utils_1.tsConvert.asTsObjectLiteralExpression(n.initializer);null==t||t.properties.forEach((t=>{var n,o;let s=null!==(o=null===(n=t.name)||void 0===n?void 0:n.getText())&&void 0!==o?o:"";if(s){let n=(0,utils_1.removeQuot)(s),o=t.getStart();n.length!=s.length&&o++,s=n;let r=e.positionAt(o);l&&l.source&&(o=l.source.offsetAt(r)),i.push({name:s,position:r,offset:o})}}))}}}if(r.length>0||u.length>0||a.length>0){let e={label:"construct-args"};e.data={state:r.length>0?r:void 0,mutations:u.length>0?u:void 0,actions:a.length>0?a:void 0};let t=new indexlib_1.IndexData;return t.categories.push("vuex-construct"),t["vuex-construct"]=[e],t}}return null}}}exports.getVuexIndexProc=getVuexIndexProc;