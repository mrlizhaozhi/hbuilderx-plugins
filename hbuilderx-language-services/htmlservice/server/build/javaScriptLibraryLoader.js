const path=require("path"),fs=require("fs"),TYPESCRIPT_LIB_SOURCE=path.join(__dirname,"../../../node_modules/typescript/lib"),JQUERY_DTS=path.join(__dirname,"../lib/jquery.d.ts");function escapeText(e){for(var t="\b".charCodeAt(0),r="\f".charCodeAt(0),n="\n".charCodeAt(0),s="\r".charCodeAt(0),a="\t".charCodeAt(0),u="\v".charCodeAt(0),i="\\".charCodeAt(0),o='"'.charCodeAt(0),c=0,l=null,h=[],p=0,b=e.length;p<b;p++){switch(e.charCodeAt(p)){case t:l="\\b";break;case r:l="\\f";break;case n:l="\\n";break;case 0:l="\\0";break;case s:l="\\r";break;case a:l="\\t";break;case u:l="\\v";break;case i:l="\\\\";break;case o:l='\\"'}null!==l&&(h.push(e.substring(c,p)),h.push(l),c=p+1,l=null)}return h.push(e.substring(c,b)),h.join("")}module.exports=function(){function e(e){return""===e?"lib.d.ts":`lib.${e}.d.ts`}function t(t){var r=path.join(TYPESCRIPT_LIB_SOURCE,e(t));return fs.readFileSync(r).toString()}var r=[],n={},s=function(e){n[e]||(n[e]=!0,r.push(e))};s("es6");for(var a=[];r.length>0;){var u=r.shift(),i=t(u).split(/\r\n|\r|\n/),o=[];for(let e=0;e<i.length;e++){let t=i[e].match(/\/\/\/\s*<reference\s*lib="([^"]+)"/);t&&s(t[1]),o.push(i[e])}a.push({name:e(u),output:`"${escapeText(o.join("\n"))}"`})}i=fs.readFileSync(JQUERY_DTS).toString().split(/\r\n|\r|\n/);a.push({name:"jquery",output:`"${escapeText(i.join("\n"))}"`}),strResult="\nconst libs : { [name:string]: string; } = {\n";for(let e=a.length-1;e>=0;e--)strResult+=`"${a[e].name}": ${a[e].output},\n`;return strResult+="\n};",strResult+="export function loadLibrary(name: string) : string {\n return libs[name] || ''; \n}",strResult};