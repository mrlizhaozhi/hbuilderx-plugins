"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.joinPath=exports.normalizePath=exports.resolvePath=exports.isAbsolutePath=exports.extname=exports.basename=exports.dirname=exports.getScheme=exports.getRequestService=exports.FileType=exports.FsReadDirRequest=exports.FsStatRequest=exports.FsContentRequest=void 0;const vscode_uri_1=require("vscode-uri"),vscode_languageserver_1=require("vscode-languageserver");var FsContentRequest,FsStatRequest,FsReadDirRequest,FileType;function getRequestService(e,t,s){const r={};for(let t of e)"file"===t?r[t]=s.file:"http"!==t&&"https"!==t||(r[t]=s.http);return{async stat(e){const s=r[getScheme(e)];if(s)return s.stat(e);return await t.sendRequest(FsStatRequest.type,e.toString())},readDirectory(e){const s=r[getScheme(e)];return s?s.readDirectory(e):t.sendRequest(FsReadDirRequest.type,e.toString())},getContent(e,s){const n=r[getScheme(e)];return n?n.getContent(e,s):t.sendRequest(FsContentRequest.type,{uri:e.toString(),encoding:s})}}}function getScheme(e){return e.substr(0,e.indexOf(":"))}function dirname(e){const t=e.lastIndexOf("/");return-1!==t?e.substr(0,t):""}function basename(e){const t=e.lastIndexOf("/");return e.substr(t+1)}!function(e){e.type=new vscode_languageserver_1.RequestType("fs/content")}(FsContentRequest=exports.FsContentRequest||(exports.FsContentRequest={})),function(e){e.type=new vscode_languageserver_1.RequestType("fs/stat")}(FsStatRequest=exports.FsStatRequest||(exports.FsStatRequest={})),function(e){e.type=new vscode_languageserver_1.RequestType("fs/readDir")}(FsReadDirRequest=exports.FsReadDirRequest||(exports.FsReadDirRequest={})),function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Directory=2]="Directory",e[e.SymbolicLink=64]="SymbolicLink"}(FileType=exports.FileType||(exports.FileType={})),exports.getRequestService=getRequestService,exports.getScheme=getScheme,exports.dirname=dirname,exports.basename=basename;const Slash="/".charCodeAt(0),Dot=".".charCodeAt(0);function extname(e){for(let t=e.length-1;t>=0;t--){const s=e.charCodeAt(t);if(s===Dot){if(t>0&&e.charCodeAt(t-1)!==Slash)return e.substr(t);break}if(s===Slash)break}return""}function isAbsolutePath(e){return e.charCodeAt(0)===Slash}function resolvePath(e,t){if(isAbsolutePath(t)){const s=vscode_uri_1.URI.parse(e),r=t.split("/");return s.with({path:normalizePath(r)}).toString()}return joinPath(e,t)}function normalizePath(e){const t=[];for(const s of e)0===s.length||1===s.length&&s.charCodeAt(0)===Dot||(2===s.length&&s.charCodeAt(0)===Dot&&s.charCodeAt(1)===Dot?t.pop():t.push(s));e.length>1&&0===e[e.length-1].length&&t.push("");let s=t.join("/");return 0===e[0].length&&(s="/"+s),s}function joinPath(e,...t){const s=vscode_uri_1.URI.parse(e),r=s.path.split("/");for(let e of t)r.push(...e.split("/"));return s.with({path:normalizePath(r)}).toString()}exports.extname=extname,exports.isAbsolutePath=isAbsolutePath,exports.resolvePath=resolvePath,exports.normalizePath=normalizePath,exports.joinPath=joinPath;