"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getVeturDataProviders=exports.VeturDataProvider=void 0;const fs=require("fs"),path=require("path"),vscode_uri_1=require("vscode-uri"),utils_1=require("../../../../../utils"),nuxtDataProvider_1=require("./nuxtDataProvider"),veturProviderParse_1=require("./veturProviderParse");var veturProviderParse_2=require("./veturProviderParse");function getVeturDataProviders(e){const t=vscode_uri_1.URI.parse(e).fsPath;let r=[];const s=utils_1.hx.createProject(t).kind===utils_1.hx.HXProjectKind.UniApp;let i=path.join(t,"package.json");if(fs.existsSync(i))try{const e=JSON.parse(fs.readFileSync(i,"utf-8")),o=e.dependencies||{},n=e.devDependencies||{};if((o["nuxt-buefy"]||n["nuxt-buefy"])&&(o.buefy=!0),(o["@nuxtjs/vuetify"]||n["@nuxtjs/vuetify"])&&(o.vuetify=!0),(o["element-ui"]||n["element-ui"])&&r.push(veturProviderParse_1.elementTagProvider.clone()),(o["vue-onsenui"]||n["vue-onsenui"])&&r.push(veturProviderParse_1.onsenTagProvider.clone()),o.gridsome&&r.push(veturProviderParse_1.gridsomeTagProvider.clone()),n["quasar-cli"]&&(o["quasar-framework"]="^0.0.17"),o.nuxt||o["nuxt-edge"]||n.nuxt||n["nuxt-edge"]){const e=(0,nuxtDataProvider_1.getNuxtDataProvider)(t);e&&r.push(e)}const u=(0,veturProviderParse_1.getWorkspaceDataProvider)(t,e);u&&r.push(u);let a=new Set;for(const e of[...Object.keys(o),...Object.keys(n)]){let s;try{s=require.resolve(path.join(e,"package.json"),{paths:[t]})}catch(e){continue}const i=JSON.parse(fs.readFileSync(s,"utf-8"));if(i){const s=(0,veturProviderParse_1.getDependencyDataProvider)(t,e,i);s&&(a.add(e),r.push(s))}}if(!a.has("vue-router")){let e=path.join(utils_1.hx.getExtensionRootPath(),"builtin-dts/node_modules/vue-router");const t=path.join(e,"package.json");if(fs.existsSync(t)){const s=JSON.parse(fs.readFileSync(t,"utf-8"));if(s){const t=(0,veturProviderParse_1.getDependencyDataProvider)(e,"vue-router",s);t&&r.push(t)}}}if(!a.has("vue-i18n")&&s){let e=path.join(utils_1.hx.getExtensionRootPath(),"builtin-dts/node_modules/vue-i18n");const t=path.join(e,"package.json");if(fs.existsSync(t)){const s=JSON.parse(fs.readFileSync(t,"utf-8"));if(s){const t=(0,veturProviderParse_1.getDependencyDataProvider)(e,"vue-i18n",s);t&&r.push(t)}}}}catch(e){console.error(e.stack)}try{let e=utils_1.hx.createProject(t);if(e&&e.kind==utils_1.hx.HXProjectKind.UniApp){["vue-router","vue-i18n"].forEach((e=>{if(!r.find((t=>t.getId()==e))){let t=path.join(utils_1.hx.getExtensionRootPath(),"builtin-dts/node_modules/"+e);const s=path.join(t,"package.json");if(fs.existsSync(s)){const i=JSON.parse(fs.readFileSync(s,"utf-8"));if(i){const s=(0,veturProviderParse_1.getDependencyDataProvider)(t,e,i);s&&r.push(s)}}}}))}}catch(e){}return r}Object.defineProperty(exports,"VeturDataProvider",{enumerable:!0,get:function(){return veturProviderParse_2.VeturDataProvider}}),exports.getVeturDataProviders=getVeturDataProviders;