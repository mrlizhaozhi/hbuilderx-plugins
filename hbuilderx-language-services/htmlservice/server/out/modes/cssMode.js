"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCSSMode=void 0;const languageModelCache_1=require("../languageModelCache"),embeddedSupport_1=require("./embeddedSupport"),cssModeExtension_1=require("../modes-ext/cssModeExtension"),embeddedCssFormatting_1=require("./embeddedCssFormatting");function getCSSMode(e,t,n){let o=(0,languageModelCache_1.getLanguageModelCache)(10,60,(e=>t.get(e).getEmbeddedDocument("css"))),s=(0,languageModelCache_1.getLanguageModelCache)(10,60,(t=>e.parseStylesheet(t))),d=(0,cssModeExtension_1.getCssModeExt)(e,n),g=(0,embeddedCssFormatting_1.getCssFormatting)(t,"css"),r={};return{getId:()=>"css",async doValidation(t,d=n.settings){let g=o.get(t);return e.doValidation(g,s.get(g),d&&d.css)},async doComplete(t,g,r,a=n.settings){let i=o.get(t);const c=s.get(i);let l=await d.doComplete(t,i,g,c,r);return l||await e.doComplete2(i,g,c,r)},async doHover(t,n){let d=o.get(t);return e.doHover(d,n,s.get(d))},async findDocumentHighlight(t,n){let d=o.get(t);return e.findDocumentHighlights(d,n,s.get(d))},async findDocumentSymbols(e){let t=o.get(e);return d.findDocumentSymbols(t,s.get(t)).filter((e=>e.name!==embeddedSupport_1.CSS_STYLE_RULE))},async findDefinition(e,t){let n=o.get(e),g=s.get(n);return await d.findDefinition(e,n,t,g)},async findReferences(t,n){let d=o.get(t);return e.findReferences(d,n,s.get(d))},async findDocumentColors(t){let n=o.get(t);return e.findDocumentColors(n,s.get(n))},async getColorPresentations(t,n,d){let g=o.get(t);return e.getColorPresentations(g,s.get(g),n,d)},format:async(e,t,n,o=r)=>g.doFormatting(e,t,n,o),async getFoldingRanges(t){let n=o.get(t);return e.getFoldingRanges(n,{})},async getSelectionRange(t,n){let d=o.get(t);return e.getSelectionRanges(d,[n],s.get(d))[0]},onDocumentRemoved(e){o.onDocumentRemoved(e),s.onDocumentRemoved(e)},dispose(){o.dispose(),s.dispose()}}}exports.getCSSMode=getCSSMode;