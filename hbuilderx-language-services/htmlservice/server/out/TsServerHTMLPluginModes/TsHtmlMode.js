"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HtmlEmbedMode=void 0;const vscode_uri_1=require("vscode-uri"),core_1=require("../../../../core"),HtmlExtraType_1=require("./HtmlExtraType");class HtmlEmbedMode{constructor(t,e,i){this.info=t,this.htmlCachesInProjectScope=e,this.htmlLanguageService=i,this.htmlTsStyleDefinitionSourceMap=new HtmlExtraType_1.HtmlTsDefinitionSourceMap(t,e)}initialize(t,e){const i=this.htmlCachesInProjectScope.getUpToDateInfo(t);if(!i)return;let o=i.htmlDocument,n=this.htmlLanguageService;if(!n)return;let r=n.parseHTMLDocument(o),s=o.positionAt(e);return{document:o,htmlDocument:r,position:s}}getCompletionsAtPosition(t,e,i,o){const n=this.info,r=this.initialize(e,i);if(!r)return;const s=this.htmlLanguageService,c=r.document,m=r.htmlDocument,l=r.position;let u=s.doComplete(c,l,m);return(0,core_1.fromLspCompletions)(u,c,n.ts)}getCompletionEntryDetails(t,e,i,o,n,r,s,c){if(!r)return;let m=vscode_uri_1.URI.parse(r).query,l=JSON.parse(m);const u=this.info,h=this.initialize(e,i);if(!h)return;const a=this.htmlLanguageService,p=h.document,f=h.htmlDocument,d=h.position;let g={label:o,...l},D=a.doResolve(g,p,d,f);return(0,core_1.fromLspCompletionDetail)(D,p,u.ts)}getQuickInfoAtPosition(t,e,i){this.info;const o=this.initialize(e,i);if(!o)return;const n=this.htmlLanguageService,r=o.document,s=o.htmlDocument,c=o.position;let m=n.doHover(r,c,s);return null!==m?(0,core_1.fromLspHover)(m,r,this.info.ts):void 0}getSignatureHelpItems(t,e,i,o){}getDefinitionAndBoundSpan(t,e,i){const o=this.info,n=this.initialize(e,i);if(!n)return;const r=this.htmlLanguageService,s=n.document,c=n.htmlDocument,m=n.position;let l=r.findDefinition(s,m,c);return(0,core_1.fromLspDefinition)(l,s,o,void 0)}getNavigationTree(t,e){let i;const o=this.htmlCachesInProjectScope.getUpToDateInfo(e);if(!o)return;const n=this.htmlLanguageService,r=o.htmlDocument,s=n.parseHTMLDocument(o.htmlDocument);let c=n.findDocumentSymbols(r,s);return i=(0,core_1.fromLspNavigation)(c,r,this.info.ts,!0),i}findReferences(t,e,i){throw new Error("Method not implemented.")}}exports.HtmlEmbedMode=HtmlEmbedMode;