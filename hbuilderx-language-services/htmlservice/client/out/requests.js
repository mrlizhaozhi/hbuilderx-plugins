"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.joinPath=exports.normalizePath=exports.resolvePath=exports.isAbsolutePath=exports.basename=exports.dirname=exports.getScheme=exports.FileType=exports.serveFileSystemRequests=exports.FsReadDirRequest=exports.FsStatRequest=exports.FsContentRequest=void 0;const vscode_1=require("vscode"),vscode_languageclient_1=require("vscode-languageclient");var FsContentRequest,FsStatRequest,FsReadDirRequest,FileType;function serveFileSystemRequests(e,t){e.onRequest(FsContentRequest.type,(e=>{const s=vscode_1.Uri.parse(e.uri);return"file"===s.scheme&&t.fs?t.fs.getContent(e.uri):vscode_1.workspace.fs.readFile(s).then((s=>new t.TextDecoder(e.encoding).decode(s)))})),e.onRequest(FsReadDirRequest.type,(e=>{const s=vscode_1.Uri.parse(e);return"file"===s.scheme&&t.fs?t.fs.readDirectory(e):vscode_1.workspace.fs.readDirectory(s)})),e.onRequest(FsStatRequest.type,(e=>{const s=vscode_1.Uri.parse(e);return"file"===s.scheme&&t.fs?t.fs.stat(e):vscode_1.workspace.fs.stat(s)}))}function getScheme(e){return e.substr(0,e.indexOf(":"))}function dirname(e){const t=e.lastIndexOf("/");return-1!==t?e.substr(0,t):""}function basename(e){const t=e.lastIndexOf("/");return e.substr(t+1)}!function(e){e.type=new vscode_languageclient_1.RequestType("fs/content")}(FsContentRequest=exports.FsContentRequest||(exports.FsContentRequest={})),function(e){e.type=new vscode_languageclient_1.RequestType("fs/stat")}(FsStatRequest=exports.FsStatRequest||(exports.FsStatRequest={})),function(e){e.type=new vscode_languageclient_1.RequestType("fs/readDir")}(FsReadDirRequest=exports.FsReadDirRequest||(exports.FsReadDirRequest={})),exports.serveFileSystemRequests=serveFileSystemRequests,function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Directory=2]="Directory",e[e.SymbolicLink=64]="SymbolicLink"}(FileType=exports.FileType||(exports.FileType={})),exports.getScheme=getScheme,exports.dirname=dirname,exports.basename=basename;const Slash="/".charCodeAt(0),Dot=".".charCodeAt(0);function isAbsolutePath(e){return e.charCodeAt(0)===Slash}function resolvePath(e,t){return isAbsolutePath(t)?e.with({path:normalizePath(t.split("/"))}):joinPath(e,t)}function normalizePath(e){const t=[];for(const s of e)0===s.length||1===s.length&&s.charCodeAt(0)===Dot||(2===s.length&&s.charCodeAt(0)===Dot&&s.charCodeAt(1)===Dot?t.pop():t.push(s));e.length>1&&0===e[e.length-1].length&&t.push("");let s=t.join("/");return 0===e[0].length&&(s="/"+s),s}function joinPath(e,...t){const s=e.path.split("/");for(let e of t)s.push(...e.split("/"));return e.with({path:normalizePath(s)})}exports.isAbsolutePath=isAbsolutePath,exports.resolvePath=resolvePath,exports.normalizePath=normalizePath,exports.joinPath=joinPath;