"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.activateTagClosing=void 0;const vscode_1=require("vscode");function activateTagClosing(e,t,i){let n=[];vscode_1.workspace.onDidChangeTextDocument((t=>function(t,i){if(!c)return;let n=vscode_1.window.activeTextEditor&&vscode_1.window.activeTextEditor.document;if(t!==n||0===i.length)return;void 0!==o&&clearTimeout(o);let r=i[i.length-1],s=r.text[r.text.length-1];if(r.rangeLength>0||">"!==s&&"/"!==s)return;let a=r.range.start,d=t.version;o=setTimeout((()=>{let i=new vscode_1.Position(a.line,a.character+r.text.length);e(t,i).then((e=>{if(e&&c){let n=vscode_1.window.activeTextEditor;if(n){let o=n.document;if(t===o&&o.version===d){let t=n.selections;t.length&&t.some((e=>e.active.isEqual(i)))?n.insertSnippet(new vscode_1.SnippetString(e),t.map((e=>e.active))):n.insertSnippet(new vscode_1.SnippetString(e),i)}}}})),o=void 0}),100)}(t.document,t.contentChanges)),null,n);let o,c=!1;function r(){c=!1;let e=vscode_1.window.activeTextEditor;if(!e)return;let n=e.document;t[n.languageId]&&vscode_1.workspace.getConfiguration(void 0,n.uri).get(i)&&(c=!0)}return r(),vscode_1.window.onDidChangeActiveTextEditor(r,null,n),vscode_1.Disposable.from(...n)}exports.activateTagClosing=activateTagClosing;