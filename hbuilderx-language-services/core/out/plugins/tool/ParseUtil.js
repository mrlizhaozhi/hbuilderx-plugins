"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ParseUtil=void 0;const ts=require("typescript/lib/tsserverlibrary");var ParseUtil;!function(t){function e(t){const e=function(t){switch(t.kind){case ts.SyntaxKind.StringLiteral:case ts.SyntaxKind.NoSubstitutionTemplateLiteral:case ts.SyntaxKind.NumericLiteral:if(t.parent.kind===ts.SyntaxKind.ComputedPropertyName)return ts.isObjectLiteralElement(t.parent.parent)?t.parent.parent:void 0;case ts.SyntaxKind.Identifier:return!ts.isObjectLiteralElement(t.parent)||t.parent.parent.kind!==ts.SyntaxKind.ObjectLiteralExpression&&t.parent.parent.kind!==ts.SyntaxKind.JsxAttributes||t.parent.name!==t?void 0:t.parent}return}(t);return e&&(ts.isObjectLiteralExpression(e.parent)||ts.isJsxAttributes(e.parent))?e:void 0}function n(t){return t.kind===ts.SyntaxKind.ComputedPropertyName?ts.isStringLiteralLike(t.expression)||ts.isNumericLiteral(t.expression)?t.expression.text:void 0:ts.isPrivateIdentifier(t)?ts.idText(t):(e=t,ts.isMemberName(e)?ts.idText(e):e.text);var e}function i(t,i){if(!t||!t.parent)return[];var r=e(t);if(r){const t=n(r.name);if(!t)return[];var s=i.getContextualType(r.parent);if(s){var a=s.getProperty(t);if(a)return[a]}}return[i.getSymbolAtLocation(t)]}function r(t){if(t.kind===ts.SyntaxKind.SourceFile){let e=t.statements;for(let t=0;t<(null==e?void 0:e.length);++t){let n=e[t];if((null==n?void 0:n.kind)===ts.SyntaxKind.ExportAssignment){let t=n.expression;for(let e=0;e<t.getChildCount();++e){let n=t.getChildAt(e);if(n.kind===ts.SyntaxKind.SyntaxList)return n}}}}return null}function s(t){var e,n;let i={mapActions:null,mapMutations:null},s=function(t){let e=r(t);if(e)for(let t=0;t<e.getChildCount();++t){let n=e.getChildAt(t);if(n.kind===ts.SyntaxKind.PropertyAssignment){let t=n;if("methods"===t.name.getText()&&(null==t?void 0:t.initializer.kind)===ts.SyntaxKind.ObjectLiteralExpression)return t.initializer}}return null}(t);if(s&&s.kind===ts.SyntaxKind.ObjectLiteralExpression){let t=s;for(let r=0;r<t.properties.length;++r){let s=t.properties[r];if(s.kind===ts.SyntaxKind.SpreadAssignment){let t=s.expression;if(t.kind===ts.SyntaxKind.CallExpression&&(null===(e=t)||void 0===e?void 0:e.expression.kind)===ts.SyntaxKind.Identifier){let e=null===(n=t)||void 0===n?void 0:n.expression;"mapActions"===e.escapedText?i.mapActions=t.arguments[0]:"mapMutations"===e.escapedText&&(i.mapMutations=t.arguments[0])}}}}return i}function a(t){let e=[],n=r(t);if(n)for(let t=0;t<n.getChildCount();++t){let i=n.getChildAt(t);if(i.kind===ts.SyntaxKind.PropertyAssignment){let t=i;if("computed"===t.name.getText()&&(null==t?void 0:t.initializer.kind)===ts.SyntaxKind.CallExpression){let n=t.initializer;if(n.expression.kind===ts.SyntaxKind.Identifier&&"mapState"===n.expression.escapedText){let t=n.arguments[0];if(!t)return e;e.push(...o(t))}}}}return e}function o(t){let e=[];if(!t)return e;if(t.kind===ts.SyntaxKind.ObjectLiteralExpression){t.forEachChild((t=>{if(t.kind===ts.SyntaxKind.PropertyAssignment){let n=t.name.getText();e.push(n)}}))}else if(t.kind===ts.SyntaxKind.ArrayLiteralExpression){t.forEachChild((t=>{if(t.kind===ts.SyntaxKind.StringLiteral){let n=t.text;e.push(n)}}))}return e}function l(t){let e=[];const{mapActions:n}=s(t);return n&&e.push(...o(n)),e}function u(t){let e=[];const{mapMutations:n}=s(t);return n&&e.push(...o(n)),e}t.getDefinitionSymbolAtLocation=i,t.getTypesAtLocation=function(t,e,n){if(!t||!t.parent)return[];let r=e.getProgram();if(null==r)return[];let s=r.getTypeChecker();switch(t.parent.kind){case ts.SyntaxKind.PropertyAccessExpression:{let e=null,n=t.parent.expression;if(n.kind===ts.SyntaxKind.PropertyAccessExpression){if(e=n.name,n.expression.kind===ts.SyntaxKind.PropertyAccessExpression){let t=i(e,s);for(let e=0;e<t.length;++e){if(!t[e])continue;let n=s.getTypeOfSymbolAtLocation(t[e],t[e].valueDeclaration);if("Dictionary<string>"===s.typeToString(n))return["VueRouterParams"]}}}break}case ts.SyntaxKind.CallExpression:{let e=t.parent.expression;if((null==e?void 0:e.kind)===ts.SyntaxKind.ImportKeyword){return["HBuilderX.ImportURIString"]}if(ts.isIdentifier(e)&&"require"===e.getText())return["HBuilderX.RequireCommonString"];break}case ts.SyntaxKind.BinaryExpression:{let e=t.parent,n=s.getTypeAtLocation(e.left);if(n){return s.typeToString(n).split("|").map((t=>t.trim()))}break}case ts.SyntaxKind.ImportDeclaration:{let t=["HBuilderX.ImportURIString"];return n&&(n.endsWith(".vue.js")||n.endsWith(".nvue.js")||n.endsWith(".vue.ts")||n.endsWith(".nvue.ts"))&&t.push("HBuilderX.VueFileURIString"),t}}let a=s.getContextualType(t);if(a){return s.typeToString(a).split("|").map((t=>t.trim()))}return[]},t.getVuexState=a,t.getVuexActions=l,t.getVuexMutations=u,t.getVuexInfo=function(t){return{state:a(t),actions:l(t),mutations:u(t)}}}(ParseUtil=exports.ParseUtil||(exports.ParseUtil={}));