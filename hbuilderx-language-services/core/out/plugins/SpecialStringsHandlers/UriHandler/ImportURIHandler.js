"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const vscode_languageserver_protocol_1=require("vscode-languageserver-protocol"),lspUtil_1=require("../../../base/lspUtil"),project_1=require("../../../base/project"),URIHandler_1=require("./URIHandler");class ImportURIHandler extends URIHandler_1.default{constructor(e,t){super(e,t),this.doComplete=(e,t,r,o,n,s)=>{let a=r.project.fsPath,l=r.project.sourceRoot,i=(0,lspUtil_1.getContextData)(e,e.offsetAt(t),"'\"");if(s&&(n=(0,URIHandler_1.sortProcessing)(n,i.contextRange)),r.project.kind!==project_1.HXProjectKind.UniApp&&i.context.startsWith("@"))return n;let c={extSuffixFilterList:this._exts,prefixPath:i.leftText,enableShowFolders:this._enableShowFolders};r.project.kind===project_1.HXProjectKind.UniApp&&(c.extSuffixFilterList=[".js",".uts"]);let p=i.contextRange,g=!1;if(this._enableShowFolders){let r=e.offsetAt(t)-e.offsetAt(i.leftRange.start),o=(0,lspUtil_1.getFragmentString)(i.context,r,"\\/"),n=(0,lspUtil_1.getContextData)(e,e.offsetAt(t),"\\/");o===n.context&&(c.onlyFolders=!0,c.onlyCurrentLevel=!0,p=n.contextRange,p.end.character+=1,g=!0)}let d=(0,URIHandler_1.getCompletionPathListSync)(a,l,c,e.uri),_=i.context.startsWith("@"),u=(0,URIHandler_1.getPathCompletionItem)(d,e,p,r,g,_);return n.push(...u),n}}doDefinition(e,t,r,o){let n=e.getText(r.range);if(!n.startsWith("@"))return[];let s=[],a=vscode_languageserver_protocol_1.Range.create(vscode_languageserver_protocol_1.Position.create(0,0),vscode_languageserver_protocol_1.Position.create(0,0));return s.push({targetUri:n.replace("@",r.project.fsPath),targetRange:a,targetSelectionRange:a,originSelectionRange:r.range}),s}}exports.default=ImportURIHandler;