"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const vscode_languageserver_protocol_1=require("vscode-languageserver-protocol"),vscode_uri_1=require("vscode-uri"),indexlib_1=require("../../../../indexlib"),hx=require("../../index");function getExportNameValue(e,t){let r=e.statements.find(t.isExportAssignment);if(r){let e=r.getChildren().find(t.isObjectLiteralExpression);if(e){let r=e.properties.find((e=>e.kind==t.SyntaxKind.PropertyAssignment&&/['\"]?name['\"]?/.test(e.name.getText())));if(r){let e=r.initializer;if(t.isStringLiteral(e)){let t=e.text,r=t[0];"'"!=r&&'"'!=r||(t=t.slice(0));let i=t[t.length-1];return"'"!=i&&'"'!=i||(t=t.slice(0,-1)),t}}}}return""}class VueEventHandler{doComplete(e,t,r,i,n,o){let l=[],a=getExportNameValue(r.ast,i.get(hx.LanguageServiceType.TS));if(a){const e=/[A-Z]/;let t=a.search(e),i="";for(;t>=0;)i+=a.slice(0,t),i+="-"+a[t].toLocaleLowerCase(),a=a.slice(t+1),t=a.search(e);i+=a;let n=vscode_uri_1.URI.file(r.project.fsPath).toString();indexlib_1.IndexDataStore.load({uri:n,name:""}).allIndexData().forEach(((e,t)=>{var r;let n=e["vue-components"];if(n instanceof Array)for(let e=0;e<n.length;e++){const t=n[e];if(t.label==i){const e=null===(r=null==t?void 0:t.data)||void 0===r?void 0:r.events;e instanceof Array&&e.forEach((e=>{"string"==typeof e&&l.push({label:e,kind:vscode_languageserver_protocol_1.CompletionItemKind.Property})}));break}}}))}return l}doCompleteResolve(e,t,r,i,n){return e}doHover(e,t,r,i){}doDefinition(e,t,r,i){return[]}doReference(e,t,r,i){return[]}}exports.default=VueEventHandler;