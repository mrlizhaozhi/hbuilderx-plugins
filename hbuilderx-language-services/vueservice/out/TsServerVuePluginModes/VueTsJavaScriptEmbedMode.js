"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VueTsJavaScriptEmbedMode=void 0;const VueTsJavaScriptExtraHandle_1=require("./VueTsJavaScriptExtraHandle");class VueTsJavaScriptEmbedMode{constructor(e,t){this.info=e,this.vueCachesInProjectScope=t,this.tsVueExtraCompletionHandle=new VueTsJavaScriptExtraHandle_1.VueTsJavaScriptExtraCompletionHandle(e,t)}getCompletionsAtPosition(e,t,i,o){let n,s=this.vueCachesInProjectScope.getEmbeddedFile(t);if(!s)return n;let r=s.file;return r&&r.isTsHostFile?(n=e.getCompletionsAtPosition(r.fileName,i,o),n=this.tsVueExtraCompletionHandle.doExtraCompletion(n,e,t,i,o),n&&(n.entries=n.entries.filter((e=>-1===e.name.indexOf("__VLS_")))),n):n}getCompletionEntryDetails(e,t,i,o,n,s,r,l){var a;let d=null===(a=this.vueCachesInProjectScope.getEmbeddedFile(t))||void 0===a?void 0:a.file;if(!d||!d.isTsHostFile)return;let u=e.getProgram();if(!u)return;let c=u.getSourceFile(d.fileName);if(!c)return;let m=u.getTypeChecker(),f=this.info.ts.getTokenAtPosition(c,i-1);if("vls_completion"===s){let e=m.getSymbolsInScope(f,this.info.ts.SymbolFlags.Variable);if(!e)return;let t=e.find((e=>e.escapedName===o));if(!t)return;let n=this.info.ts.getTouchingPropertyName(c,i-1);const{displayParts:s,documentation:r,symbolKind:l,tags:a}=this.info.ts.SymbolDisplay.getSymbolDisplayPartsDocumentationAndSymbolKind(m,t,c,n,n,7);return this.info.ts.Completions.createCompletionDetails(t.name,this.info.ts.SymbolDisplay.getSymbolModifiers(m,t),l,s,r,a,void 0,void 0)}return e.getCompletionEntryDetails(t,i,o,n,s,r,l)}getQuickInfoAtPosition(e,t,i){let o=this.vueCachesInProjectScope.getEmbeddedFile(t);if(!o)return;let n=o.file;return n&&n.isTsHostFile?e.getQuickInfoAtPosition(n.fileName,i):void 0}getSignatureHelpItems(e,t,i,o){let n=this.vueCachesInProjectScope.getEmbeddedFile(t);if(!n)return;let s=n.file;return s&&s.isTsHostFile?e.getSignatureHelpItems(s.fileName,i,o):void 0}getDefinitionAndBoundSpan(e,t,i){let o=this.vueCachesInProjectScope.getEmbeddedFile(t);if(!o)return;let n=o.file;return n&&n.isTsHostFile?e.getDefinitionAndBoundSpan(n.fileName,i):void 0}getNavigationTree(e,t){let i,o=this.vueCachesInProjectScope.getEmbeddedFile(t);if(!o)return i;let n=o.file;return n&&n.isTsHostFile?(i=e.getNavigationTree(n.fileName),i):i}findReferences(e,t,i){return e.findReferences(t,i)}}exports.VueTsJavaScriptEmbedMode=VueTsJavaScriptEmbedMode;