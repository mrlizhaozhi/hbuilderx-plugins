"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.parseDotValueRanges=exports.parseDeclarationRanges=exports.parseRefSugarCallRanges=exports.parseRefSugarDeclarationRanges=void 0;const scriptSetupRanges_1=require("./scriptSetupRanges");function parseRefSugarDeclarationRanges(e,t,n){const s=[];return t.forEachChild((e=>{r(e)})),s;function a(e){return(0,scriptSetupRanges_1.getStartEnd)(e,t)}function r(i){if(e.isVariableDeclarationList(i)&&1===i.declarations.length){const r=i.declarations[0],o=r.name,g=r.initializer;if(g&&e.isCallExpression(g)&&e.isIdentifier(g.expression)){const r=g.expression.getText(t);if(n.some((e=>e===r))){const n=a(i).start,r={start:n,end:n+(i.flags===e.NodeFlags.Const?"count".length:"let".length)},l=(0,scriptSetupRanges_1.findBindingVars)(e,o,t),c=a(g.expression);s.push({flag:r,leftBindings:l,rightFn:c})}}}i.forEachChild((e=>r(e)))}}function parseRefSugarCallRanges(e,t,n){const s=[];return t.forEachChild((e=>{r(e)})),s;function a(e){return(0,scriptSetupRanges_1.getStartEnd)(e,t)}function r(i){if(e.isCallExpression(i)&&e.isIdentifier(i.expression)&&i.arguments.length){const e=i.expression.getText(t);if(n.some((t=>t===e))){const e=i.arguments[0],n=i.arguments[i.arguments.length-1];s.push({fullRange:a(i),argsRange:{start:e.getStart(t),end:n.getEnd()}})}}i.forEachChild((e=>r(e)))}}function parseDeclarationRanges(e,t){const n=[];return t.forEachChild((e=>{a(e)})),n;function s(e){return(0,scriptSetupRanges_1.getStartEnd)(e,t)}function a(r){if(e.isVariableDeclarationList(r)&&1===r.declarations.length){const a=r.declarations[0],i=a.name,o=a.initializer;if(o){const a=s(r).start,g={start:a,end:a+(r.flags===e.NodeFlags.Const?"count".length:"let".length)},l=(0,scriptSetupRanges_1.findBindingVars)(e,i,t);let c;e.isCallExpression(o)&&e.isIdentifier(o.expression)&&(c=s(o.expression)),n.push({flag:g,leftIsIdentifier:e.isIdentifier(i),leftBindings:l,right:s(o),rightFn:c})}}r.forEachChild((e=>a(e)))}}function parseDotValueRanges(e,t){const n=[];return t.forEachChild((e=>{a(e)})),n;function s(e){return(0,scriptSetupRanges_1.getStartEnd)(e,t)}function a(r){if(e.isPropertyAccessExpression(r)&&e.isIdentifier(r.name)){"value"===r.name.getText(t)&&n.push({range:s(r.name),beforeDot:r.expression.getEnd()})}r.forEachChild((e=>a(e)))}}exports.parseRefSugarDeclarationRanges=parseRefSugarDeclarationRanges,exports.parseRefSugarCallRanges=parseRefSugarCallRanges,exports.parseDeclarationRanges=parseDeclarationRanges,exports.parseDotValueRanges=parseDotValueRanges;