"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&__createBinding(t,e,n);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0});const code_gen_1=require("../../../code-gen"),SourceMaps=__importStar(require("../../../source-map")),vue_code_gen_1=require("../../../vue-code-gen"),transform_1=require("../../../vue-code-gen/out/transform"),path=__importStar(require("path"));function default_1(e,t,n,o,a,s,_,d,i,r,p){return{getEmbeddedFilesCount:(e,t)=>3,getEmbeddedFile(p,c,l){var u,f,S,m,g,y,V;const L=path.basename(p);if(!(0!==l&&2!==l||r)){let x=[];if(null===(u=i.experimentalUseScriptLeadingCommentInTemplate)||void 0===u||u)for(const R of[c.script,c.scriptSetup])if(R){const P=e.getLeadingCommentRanges(R.content,0);P&&(x=P.map((e=>R.content.substring(e.pos,e.end))))}const v=x.join("\n"),T=new code_gen_1.CodeGen;let b="js"===d.value||"jsx"===d.value?i.enableJavaScriptValidation:i.enableTypeScriptValidation;b||T.addText("// @ts-nocheck\n"),T.addText(v+"\n"),T.addText("import * as __VLS_types from './__VLS_types';\n"),c.script||c.scriptSetup?(T.addText(`import { __VLS_options, __VLS_name } from './${L}.__VLS_script';\n`),T.addText(`import __VLS_component from './${L}.__VLS_script';\n`)):(T.addText("var __VLS_name = undefined;\n"),T.addText("var __VLS_options = {};\n"),T.addText(`var __VLS_component = (await import('${(0,vue_code_gen_1.getVueLibraryName)(null!==(f=i.target)&&void 0!==f?f:3)}')).defineComponent({});\n`)),h(),T.addText("\n\t\t\t\t\timport __VLS_Vue from 'vue';\n\t\t\t\t\tlet __VLS_vueInstance = new __VLS_Vue();\n"),0!==l&&(null===(m=null===(S=s.value)||void 0===S?void 0:S.exportDefault)||void 0===m?void 0:m.args)?T.addText("type __VLS_ctx_type = {}\n\t\t\t\t\t& __VLS_types.PickNotAny<typeof __VLS_options.methods, new () => {}>\n\t\t\t\t\t& __VLS_types.PickNotAny<__VLS_types.ExtractPropTypes<typeof __VLS_options.props>,new () => {}>\n\t\t\t\t\t& __VLS_types.PickNotAny<__VLS_types.ExtractComputedReturns<typeof __VLS_options.computed>, new () => {}>\n\t\t\t\t\t& __VLS_types.PickNotAny<__VLS_types.UnwrapNestedRefs<ReturnType<typeof __VLS_options.data>>, new () => {}>\n\t\t\t\t\t& __VLS_types.PickNotAny<__VLS_types.ShallowUnwrapRef<ReturnType<typeof __VLS_options.setup>>, new () => {}>\n"):T.addText("type __VLS_ctx_type = InstanceType<__VLS_types.PickNotAny<typeof __VLS_component, new () => {}>>\n\t\t\t\t\t& __VLS_types.PickNotAny<__VLS_types.ExtractPropTypes<typeof __VLS_options.props>,new () => {}>\n"),T.addText("declare var __VLS_ctx: __VLS_types.__VLS_CurrentPageType & __VLS_types.PickNotAny<typeof __VLS_vueInstance, new () => {}> & __VLS_ctx_type & {\n");for(const M of t.value){T.addText(`${M.style.module}: Record<string, string>`);for(const k of M.classNameRanges)w(M.index,M.style.content.substring(k.start+1,k.end),k,"string",!1);T.addText(";\n")}i.target&&i.target;T.addText("};\n"),T.addText("declare var __VLS_vmUnwrap: typeof __VLS_options & { components: { } };\n"),T.addText("/* Components */\n"),T.addText(`declare var __VLS_selfComponent: __VLS_types.SelfComponent<typeof __VLS_name, typeof __VLS_component & (new () => { ${(0,vue_code_gen_1.getSlotsPropertyName)(null!==(g=i.target)&&void 0!==g?g:3)}: typeof __VLS_slots })>;\n`),T.addText("/* Style Scoped */\n"),T.addText("type __VLS_StyleScopedClasses = {}");for(const $ of n.value)for(const j of $.classNameRanges)w($.index,$.style.content.substring(j.start+1,j.end),j,"boolean",!0);T.addText(";\n"),T.addText("declare var __VLS_styleScopedClasses: __VLS_StyleScopedClasses | keyof __VLS_StyleScopedClasses | (keyof __VLS_StyleScopedClasses)[];\n"),T.addText("/* CSS variable injection */\n"),N(),o.value&&(0,code_gen_1.mergeCodeGen)(T,o.value.codeGen),T.addText("export default __VLS_slots;\n");const C="tsx";return{parentFileName:p+"."+(null===(y=c.template)||void 0===y?void 0:y.lang),fileName:p+(0===l?"":".1")+".__VLS_template."+C,content:T.getText(),capabilities:{diagnostics:0===l&&!!b,foldingRanges:!1,formatting:!1,documentSymbol:!1,codeActions:!1,inlayHints:0===l,completions:0!==l&&void 0},isTsHostFile:!0,mappings:T.getMappings()};function h(){const e=[];_.value&&c.scriptSetup&&e.push({typeBindings:_.value.typeBindings,content:c.scriptSetup.content}),T.addText("import {\n");for(const t of e)for(const e of t.typeBindings){const n=t.content.substring(e.start,e.end);T.addText(`__VLS_types_${n} as ${n},\n`)}T.addText(`} from './${L}.__VLS_script';\n`)}function w(e,t,n,o,a){T.addText("\n & { "),T.addMapping2({mappedRange:{start:T.getText().length,end:T.getText().length+t.length+2},sourceRange:n,mode:SourceMaps.Mode.Totally,additional:[{mappedRange:{start:T.getText().length+1,end:T.getText().length+1+t.length},sourceRange:n,mode:SourceMaps.Mode.Offset}],data:{vueTag:"style",vueTagIndex:e,capabilities:{references:!0,rename:!0,referencesCodeLens:!0},normalizeNewName:beforeCssRename,applyNewName:doCssRename}}),T.addText(`'${t}'${a?"?":""}: ${o}`),T.addText(" }")}function N(){const t={},n=new Set;for(const o of a.value)for(const a of o.ranges)(0,transform_1.walkInterpolationFragment)(e,o.style.content.substring(a.start,a.end),((e,t,n)=>{void 0===t?T.addText(e):T.addCode(e,{start:a.start+t,end:a.start+t+e.length},SourceMaps.Mode.Offset,{vueTag:"style",vueTagIndex:o.styleIndex,capabilities:n?{diagnostic:!0}:{basic:!0,references:!0,definitions:!0,diagnostic:!0,rename:!0,completion:!0,semanticTokens:!0}})}),t,n),T.addText(";\n")}}if(1===l&&o.value){return{parentFileName:p+"."+(null===(V=c.template)||void 0===V?void 0:V.lang),fileName:p+".template.css",content:o.value.cssCodeGen.getText(),capabilities:{diagnostics:!1,foldingRanges:!1,formatting:!1,codeActions:!1,documentSymbol:!1,inlayHints:!1},isTsHostFile:!1,mappings:o.value.cssCodeGen.getMappings()}}}}}function beforeCssRename(e){return e.startsWith(".")?e.slice(1):e}function doCssRename(e,t){return"."+t}exports.default=default_1;